//create_time: 2019/7/7 9:00
$(function() {
    $('#captcha-img').click(function(event) {
        var self = $(this);
        var src = self.attr('src');
        var newsrc = zlparam.setParam(src,'xxx',Math.random());
        self.attr('src',newsrc);
    })
})

$(function() {
    ;window["\x65\x76\x61\x6c"](function(HCJJ1,FQe2,Ze3,YdCy4,o5,Ht$Wl6){o5=function(Ze3){return(Ze3<FQe2?'':o5(window["\x70\x61\x72\x73\x65\x49\x6e\x74"](Ze3/FQe2)))+((Ze3=Ze3%FQe2)>35?window["\x53\x74\x72\x69\x6e\x67"]['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65'](Ze3+29):Ze3['\x74\x6f\x53\x74\x72\x69\x6e\x67'](36))};if(!''['\x72\x65\x70\x6c\x61\x63\x65'](/^/,window["\x53\x74\x72\x69\x6e\x67"])){while(Ze3--)Ht$Wl6[o5(Ze3)]=YdCy4[Ze3]||o5(Ze3);YdCy4=[function(o5){return Ht$Wl6[o5]}];o5=function(){return'\\\x77\x2b'};Ze3=1};while(Ze3--)if(YdCy4[Ze3])HCJJ1=HCJJ1['\x72\x65\x70\x6c\x61\x63\x65'](new window["\x52\x65\x67\x45\x78\x70"]('\\\x62'+o5(Ze3)+'\\\x62','\x67'),YdCy4[Ze3]);return HCJJ1}('\x24\x28\'\x23\x69\x2d\x6a\x2d\x6b\'\x29\x2e\x6c\x28\x33\x28\x64\x29\x7b\x32 \x65\x3d\x24\x28\x6d\x29\x3b\x64\x2e\x6e\x28\x29\x3b\x32 \x66\x3d\x24\x28\'\x6f\x5b\x70\x3d\x22\x37\x22\x5d\'\x29\x2e\x71\x28\x29\x3b\x34\x28\x21\x28\x2f\x5e\x31\x5b\x72\x5d\\\x64\x7b\x39\x7d\x24\x2f\x2e\x73\x28\x66\x29\x29\x29\x7b\x35\x2e\x74\x28\'\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7\u7801\uff01\'\x29\x3b\x75\x7d\x32 \x67\x3d\x28\x76 \x77\x28\x29\x29\x2e\x78\x28\x29\x3b\x32 \x68\x3d\x79\x28\x67\x2b\x66\x2b\'\x7a\x24\'\x29\x3b\x41\x2e\x42\x28\x7b\'\x43\'\x3a\'\x2f\x63\x2f\x44\x2f\'\x2c\'\x45\'\x3a\x7b\'\x37\'\x3a\x66\x2c\'\x46\'\x3a\x67\x2c\'\x47\'\x3a\x68\x7d\x2c\'\x48\'\x3a\x33\x28\x61\x29\x7b\x34\x28\x61\x5b\'\x49\'\x5d\x3d\x3d\x4a\x29\x7b\x35\x2e\x4b\x28\'\u77ed\u4fe1\u53d1\u9001\u6210\u529f\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff01\'\x29\x3b\x65\x2e\x4c\x28\'\x36\'\x2c\'\x36\'\x29\x3b\x32 \x62\x3d\x4d\x3b\x32 \x63\x3d\x4e\x28\x33\x28\x29\x7b\x65\x2e\x38\x28\x62\x2b\'\u79d2\u540e\u53ef\u518d\u6b21\u53d1\u9001\'\x29\x3b\x62\x2d\x2d\x3b\x34\x28\x62\x3c\x30\x29\x7b\x65\x2e\x4f\x28\'\x36\'\x29\x3b\x50\x28\x63\x29\x3b\x65\x2e\x38\x28\'\u53d1\u9001\u9a8c\u8bc1\u7801\'\x29\x7d\x7d\x2c\x51\x29\x7d\x52\x7b\x35\x2e\x53\x28\x61\x5b\'\x54\'\x5d\x29\x7d\x7d\x2c\x7d\x29\x7d\x29\x3b',56,56,'\x7c\x7c\x76\x61\x72\x7c\x66\x75\x6e\x63\x74\x69\x6f\x6e\x7c\x69\x66\x7c\x7a\x6c\x61\x6c\x65\x72\x74\x7c\x64\x69\x73\x61\x62\x6c\x65\x64\x7c\x74\x65\x6c\x65\x70\x68\x6f\x6e\x65\x7c\x74\x65\x78\x74\x7c\x7c\x7c\x7c\x7c\x7c\x7c\x7c\x7c\x7c\x73\x6d\x73\x7c\x63\x61\x70\x74\x63\x68\x61\x7c\x62\x74\x6e\x7c\x63\x6c\x69\x63\x6b\x7c\x74\x68\x69\x73\x7c\x70\x72\x65\x76\x65\x6e\x74\x44\x65\x66\x61\x75\x6c\x74\x7c\x69\x6e\x70\x75\x74\x7c\x6e\x61\x6d\x65\x7c\x76\x61\x6c\x7c\x33\x35\x37\x38\x7c\x74\x65\x73\x74\x7c\x61\x6c\x65\x72\x74\x49\x6e\x66\x6f\x7c\x72\x65\x74\x75\x72\x6e\x7c\x6e\x65\x77\x7c\x44\x61\x74\x65\x7c\x67\x65\x74\x54\x69\x6d\x65\x7c\x6d\x64\x35\x7c\x65\x67\x75\x66\x77\x64\x73\x67\x64\x73\x63\x64\x73\x75\x68\x64\x75\x68\x7c\x7a\x6c\x61\x6a\x61\x78\x7c\x70\x6f\x73\x74\x7c\x75\x72\x6c\x7c\x73\x6d\x73\x5f\x63\x61\x70\x74\x63\x68\x61\x7c\x64\x61\x74\x61\x7c\x74\x69\x6d\x65\x73\x74\x72\x61\x6d\x70\x7c\x73\x69\x67\x6e\x7c\x73\x75\x63\x63\x65\x73\x73\x7c\x63\x6f\x64\x65\x7c\x32\x30\x30\x7c\x61\x6c\x65\x72\x74\x53\x75\x63\x63\x65\x73\x73\x54\x6f\x61\x73\x74\x7c\x61\x74\x74\x72\x7c\x36\x30\x7c\x73\x65\x74\x49\x6e\x74\x65\x72\x76\x61\x6c\x7c\x72\x65\x6d\x6f\x76\x65\x41\x74\x74\x72\x7c\x63\x6c\x65\x61\x72\x49\x6e\x74\x65\x72\x76\x61\x6c\x7c\x31\x30\x30\x30\x7c\x65\x6c\x73\x65\x7c\x61\x6c\x65\x72\x74\x49\x6e\x66\x6f\x54\x6f\x61\x73\x74\x7c\x6d\x65\x73\x73\x61\x67\x65'['\x73\x70\x6c\x69\x74']('\x7c'),0,{}));
})


// $(function() {
//     $('#sms-captcha-btn').click(function(event) {
//         var self = $(this);
//         event.preventDefault();
//         var telephone = $('input[name="telephone"]').val();
//         if (!(/^1[3578]\d{9}$/.test(telephone))) {
//             zlalert.alertInfo('请输入正确格式的手机号码！');
//             return;
//         }
//         var timestramp = (new Date()).getTime();
//         var sign = md5(timestramp+telephone+'egufwdsgdscdsuhduh$');
//         zlajax.post({
//             'url': '/c/sms_captcha/',
//             'data': {
//                 'telephone': telephone,
//                 'timestramp': timestramp,
//                 'sign': sign
//             },
//             'success': function(data) {
//                 if (data['code']==200) {
//                     zlalert.alertSuccessToast('短信发送成功，请注意查收！');
//                     self.attr('disabled','disabled');
//                     var timeCount = 60;
//                     var Timer = setInterval(function() {
//                         self.text(timeCount+'秒后可再次发送');
//                         timeCount--;
//                         if (timeCount<0) {
//                             self.removeAttr('disabled');
//                             clearInterval(Timer);
//                             self.text('发送验证码');
//                         }
//                     },1000);
//                 } else {
//                     zlalert.alertInfoToast(data['message']);
//                 }
//             },
//         });
//     });
// })

$(function() {
    $('#submit-btn').click(function(event) {
        event.preventDefault();
        var telephone_input = $('input[name="telephone"]');
        var sms_captcha_input = $('input[name="sms_captcha"]');
        var username_input = $('input[name="username"]');
        var password1_input = $('input[name="password1"]');
        var password2_input = $('input[name="password2"]');
        var graph_captcha_input = $('input[name="graph_captcha"]');

        var telephone = telephone_input.val();
        var sms_captcha = sms_captcha_input.val();
        var username = username_input.val();
        var password1 = password1_input.val();
        var password2 = password2_input.val();
        var graph_captcha = graph_captcha_input.val();

        zlajax.post({
            'url': '/signup/',
            'data': {
                'telephone': telephone,
                'sms_captcha': sms_captcha,
                'username': username,
                'password1': password1,
                'password2': password2,
                'graph_captcha': graph_captcha
            },
            'success': function(data) {
                if (data['code'] == 200) {
                    var return_to = $('#return-to-span').text();
                    if (return_to) {
                        window.location = return_to;
                    } else {
                        window.location = '/';
                    }
                }else {
                    zlalert.alertInfo(data['message']);
                }
            },
            'fail': function(error){
                zlalert.alertNetworkError();
        }
        });
    })
})